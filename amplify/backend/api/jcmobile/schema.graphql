type Mutation {
  batchCreateDirectMessageUsers(dmusers: [batchCreateDirectMessageUsersInput]): [DirectMessageUser]
}

input batchCreateDirectMessageUsersInput {
  userId: ID!
  userName: String!
  roomId: ID!
}

type Tier
@model
{
  id:ID!
  name:String
  isOrgTier:String
  isIndividualTier:String
  marketingDescription:String
  productsIncluded:[String]
  groupsIncluded:[String]
  applicationProcess:ApplicationProcess
  waitForApproval:String
  enabled:String
}
type ApplicationProcess
@model
{
  id:ID!
}
type User
  @searchable
  @model
  @auth(
    rules: [
      { allow: private, provider:iam, operations:[read]}
      { allow: private, provider:userPools, operations:[read]}
      { allow: owner, ownerField: "owner" }
      { allow: groups, groups: ["verifiedUsers"], operations: [read] }
    ]
  ) {
  
  id: ID!
  given_name: String!
  family_name: String!
  email: String @auth(rules: [{ allow: owner, ownerField: "owner" },{allow:groups,groups:["admin"],operations:[read]}])
  phone: String @auth(rules: [{ allow: owner, ownerField: "owner" }])
  owner: String
  mainUserGroup:String

  hasPaidState: String
  profileState: String
  address: String @auth(rules: [{ allow: owner, ownerField: "owner" }])
  city: String @auth(rules: [{ allow: owner, ownerField: "owner" }])
  province: String @auth(rules: [{ allow: owner, ownerField: "owner" }])
  postalCode: String @auth(rules: [{ allow: owner, ownerField: "owner" }])
  country: String

  location: LatLong
  profileImage: Image
  aboutMeShort: String
  aboutMeLong: String
  interests: [String]
  currentRole: String
  currentScope: String
  personality: String
  orgName: String
  orgType: String
  orgSize: String
  denomination: String
  pplServed: String
  sundayAttendance: String
  numberVolunteers: String
  orgDescription: String
  joined: String
 
  primaryOrganization: String
  organizations: [OrganizationMember] @connection(keyName: "orgMemberByUser", fields: ["id"])
  
  owns: [Group] @connection(name: "OwnerUser", keyField: "owner")
  groups: [GroupMember] @connection(name: "UserMembers", keyField: "userID")
  messages: [Message] @connection(name: "UserMessages", keyField: "userId", sortField: "when")
  directMessages: [DirectMessage] @connection(keyName: "dmsByUser", fields: ["id"])
  
  coachingTriad:[CourseTriadCoaches] @connection(name:"courseCoachTriad",keyField: "userID")
  userTriad:[CourseTriadUsers] @connection(name:"courseUserTriad",keyField: "userID")

  courseInstructing: [CourseInstructors] @connection(name:"courseInstructorsUser",keyField: "userID")
  courseBackOfficeStaff: [CourseBackOfficeStaff] @connection(name:"courseBackOfficeStaffUser",keyField: "userID")
  payments: [Payment] @connection(name:"paymentUser",keyField: "userID")

  alertConfig:AlertConfig
}
type AlertConfig{
 
  emailDirectMessage:String
  emailGroupMessage:String
  emailEventMessage:String
  emailOrgMessage:String
  emailResourceMessage:String
  emailCourseMessage:String
  emailPromotions:String
  
}
type LatLong {
  latitude: String
  longitude: String
  geocodeFull: String
  geocodeCity: String
  geocodeRegion: String
  randomLatitude:String
  randomLongitude:String
}
type Image {
  userId: String
  filenameSmall: String
  filenameMedium: String
  filenameLarge: String
  filenameUpload: String
}
type GroupMember
  @model(queries: null)
  @key(
    name: "byGroup"
    fields: ["groupID", "userID"]
    queryField: "groupMemberByGroup"
  )
  @key(
    name: "byUser"
    fields: ["userID", "groupID"]
    queryField: "groupMemberByUser"
  ) {
  id: ID!
  groupID: ID
  userID: ID
  group: Group @connection(name: "GroupMembers", keyField: "groupID")
  user: User @connection(name: "UserMembers", keyField: "userID")
}
type Group
  @model
  @searchable
  @key(name: "byType", fields: ["type", "id"], queryField: "groupByType")
  @key(name:"byOwnerOrg", fields:["ownerOrgID","name"])
  @auth(
    rules: [
      { allow: private, provider:userPools, operations:[read]}
      { allow: owner, ownerField: "owner" }
      { allow: owner, ownerField: "ownerOrgID" }
      { allow: groups, groups: ["verifiedUsers"], operations: [read] }
      { allow: groups, groups: ["admin"]}

    ]
  ) {
  id: ID!
  owner: String!
  ownerOrgID: ID!
  ownerUser: User @connection(name: "OwnerUser", keyField: "owner")
  ownerOrg: Organization @connection(fields:["ownerOrgID"])
  type: String!
  name: String!

  description: String!
  memberCount: Int
  members: [GroupMember] @connection(name: "GroupMembers", keyField: "groupID")
  image: String!
  time: String
  lastUpdated: String
  location: String
  locationLatLong: LatLong
  length: String
  effort: String
  cost: String
  promotionalText:String
  #organizerGroup:[Group]
  #organizerUser:[User]
  #instructors:[User]
  messages: [Message] @connection(name: "RoomMessages", keyField: "roomId", sortField: "when")
  eventType: String
  eventUrl: String
  tz: String
  isSponsored: String
}
type OrganizationMember
  @model(queries: null)
  @key(name: "orgMemberByOrg", fields: ["organizationId", "userId"]) 
  @key(name: "orgMemberByUser", fields: ["userId", "organizationId"]) 
{
  id: ID!
  userRole: String!
  userId: ID!
  organizationId: ID!
  organizationName: String
  user: User! @connection(fields: ["userId"])
  organization: Organization! @connection(fields: ["organizationId"])
}
type Organization
  @model
  @key(name: "byParentOrg", fields: ["parentOrganizationId","id"])
  @auth(
    rules: [
      { allow: private, provider:userPools, operations:[read]}
      { allow: owner, ownerField: "admins" }
      { allow: owner, ownerField: "superAdmin" }
      { allow: groups, groups: ["verifiedUsers"], operations: [read] }
    ]
  ) {
  id: ID!
  orgName: String!
  adminEmail: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  phone: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  admins: [String!]!
  superAdmin: String!

  hasPaidState: String
  profileState: String
  address: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  city: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  province: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  postalCode: String @auth(rules: [{ allow: owner, ownerField: "superAdmin" }])
  country: String

  location: LatLong
  profileImage: Image
  aboutMeShort: String
  aboutMeLong: String
  orgType: String
  orgSize: String
  denomination: String
  pplServed: String
  sundayAttendance: String
  numberVolunteers: String
  orgDescription: String
  joined: String

  parentOrganizationId: ID!
  parentOrganization: Organization @connection(fields: ["parentOrganizationId"])
  subOrganizations: [Organization] @connection(keyName: "byParentOrg", fields: ["id"])

  members: [OrganizationMember] @connection(keyName: "orgMemberByOrg", fields: ["id"])
  ownsGroups: [Group] @connection(keyName: "byOwnerOrg", fields: ["id"])
  #messages: [Message] @connection(keyName: "byAuthorOrg", fields: ["id"])
  resource: [ResourceRoot] @connection(keyName: "resourceByOrganization", fields: ["id"])
}


type Payment
  @model
  @key(fields:["id"])
  @key(name: "paymentProduct", fields: ["productID"])
  @key(name: "paymentUser", fields: ["userID"],queryField:"paymentByUser")

 {
   id:ID!
   productID:String
   product:Product @connection(name:"paymentProduct",keyField:"productID")
   userID:String
   user:User @connection(name:"paymentUser",keyField:"userID")
   dateCompleted:String
   paymentType:String
   paymentInfo:String
   
 }
type CourseInfo
  @model
  @auth(
    rules: [
      { allow: owner, ownerField: "owner" }
      { allow: groups, groups: ["courseUser"], operations: [read] }
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  ) {
  id: ID!
  designedBy: String
  summary: String
  courseWeeks: [CourseWeek] @connection(name:"courseInfo",keyField: "courseInfoID",sortField:"week")
  subTitle: String
  instructors: [CourseInstructors] @connection(name:"courseInstructorsInfo",keyField: "courseInfoID")
  backOfficeStaff: [CourseBackOfficeStaff] @connection(name:"courseBackOfficeStaffInfo",keyField: "courseInfoID")
  triads: [CourseTriads] @connection(name:"courseTriads",keyField: "courseInfoID")
  introduction: String
  sylabusAttachment:String
  sylabusAttachmentName:String
}
type CourseTriads
@model
@auth(
    rules: [
      { allow: groups, groups: ["courseUser"],operations: [read]}
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )

{
  id:ID!
  courseInfoID: String
  courseInfo: CourseInfo @connection(name:"courseTriads",keyField:"courseInfoID")

  coaches: [CourseTriadCoaches] @connection(name:"courseTriadCoaches",keyField: "triadID")
  users: [CourseTriadUsers] @connection(name:"courseTriadUsers",keyField: "triadID")
}

type CourseBackOfficeStaff
@model
@auth(
    rules: [
      { allow: groups, groups: ["courseUser"],operations: [read]}
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )

{
  id:ID!
  courseInfoID: String
  courseInfo: CourseInfo @connection(name:"courseBackOfficeStaffInfo",keyField:"courseInfoID") 
  userID: String
  user: User @connection(name:"courseBackOfficeStaffUser",keyField:"userID") 
}
type CourseInstructors
@model
@auth(
    rules: [
      { allow: groups, groups: ["courseUser"],operations: [read]}
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )

{
  id:ID!
  courseInfoID: String
  courseInfo: CourseInfo @connection(name:"courseInstructorsInfo",keyField:"courseInfoID") 
  userID: String
  user: User @connection(name:"courseInstructorsUser",keyField:"userID") 
}
type CourseTriadCoaches
@model
@auth(
    rules: [
      { allow: groups, groups: ["courseUser"],operations: [read]}
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )

{
  id:ID!
  triadID: String
  triad: CourseTriads @connection(name:"courseTriadCoaches",keyField:"triadID") 
  userID: String
  user: User @connection(name:"courseCoachTriad",keyField:"userID") 
}
type CourseTriadUsers
  @key(fields:["id"])
  @key(name: "courseTriadUsers", fields: ["triadID"])
  @key(name: "courseUserTriad", fields: ["userID"],queryField:"courseTriadUserByUser")

@model
@auth(
    rules: [
      { allow: groups, groups: ["courseUser"],operations: [read]}
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )
{
  id:ID!
  triadID: String
  triad: CourseTriads @connection(name:"courseTriadUsers",keyField:"triadID") 
  userID: String
  user: User @connection(name:"courseUserTriad",keyField:"userID") 

}
type CourseWeek
 @model 
  @auth(
    rules: [
      { allow: owner, ownerField: "owner" }
      { allow: groups, groups: ["courseUser"], operations: [read] }
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )
{
  id: ID!
  week: String
  date: String
  tz:String
  name: String
  title:String
  leader: String
  courseInfoID: String
  courseInfo: CourseInfo @connection(name:"courseInfo",keyField:"courseInfoID")
  lessons: [CourseLesson] @connection(name:"courseLesson",keyField: "courseWeekID",sortField:"lesson")
}

type CourseLesson 
@model 
 @auth(
    rules: [
      { allow: owner, ownerField: "owner" }
      { allow: groups, groups: ["courseUser"], operations: [read] }
      { allow: groups, groups: ["courseCoach"], operations: [read] }
      { allow: groups, groups: ["courseAdmin"]}
    ]
  )
{
    id: ID!
  lesson:String
  lessonType:String
  name: String
  time: String
  tz:String
  duration:String
  zoomUrl:String
  zoomRecording:String
  courseLessonResponseId:String
  wordCount:String
  description: String
  courseWeekID:String
  courseWeek: CourseWeek @connection(name: "courseLesson", keyField: "courseWeekID")
 
}


type DirectMessageUser
@model
 @key(name: "byMessageRoom", fields: ["userID", "roomID"])
 @key(name: "byUser", fields: ["roomID", "userID"], queryField: "dmUsersByUser")
{
  id:ID!
  userName:String  
  userID:ID!
  user:User @connection(fields:["userID"])
  roomID:ID!
  room:DirectMessageRoom @connection(fields:["roomID"])
}
type DirectMessageRoom
@model
{
  id:ID!
  name:String
  messageUsers:[DirectMessageUser] @connection(keyName: "byUser", fields: ["id"])
  directMessage:[DirectMessage] @connection(keyName: "byMessageUser", fields: ["id"])
  roomType:String
}
type DirectMessage
@model
@key(name: "byMessageUser", fields: ["messageRoomID", "when"], queryField: "directMessagesByRoom")
@key(name: "dmsByUser", fields: ["userId", "when"])
{
  id: ID!
  content: String
    @auth(rules: [
      { allow: owner, ownerField: "userId", operations: [create, update, read] },
      { allow: owner, ownerField: "recipients", operations: [create, update, read] },
    ])
  attachment: String 
    @auth(rules: [
      { allow: owner, ownerField: "userId", operations: [create, update, read] },
      { allow: owner, ownerField: "recipients", operations: [create, update, read] },
    ])
  attachmentName: String
    @auth(rules: [
      { allow: owner, ownerField: "userId", operations: [create, update, read] },
      { allow: owner, ownerField: "recipients", operations: [create, update, read] },
    ])
  when: String!
  recipients: [String]!
  userId: ID!
  author: User @connection(fields: ["userId"])
  messageRoomID:ID!
  messageRoom:DirectMessageRoom @connection(fields:["messageRoomID"])
}

type Message
  @model
  @key(name: "ByRoom", fields: ["roomId", "when"], queryField: "messagesByRoom")
  #@key(name: "byAuthorOrg", fields:["authorOrgId", "when"])
  @auth(
    rules: [
      {allow: owner, ownerField: "owner", operations: [create, update, delete]}
      {allow: private, operations: [read] }
    ]
  ) {
  id: ID!
  content: String!
  when: String!
  attachment: String
  attachmentName: String
  roomId: ID
  userId: ID
#  authorOrgId: ID!
  postingAs: String
  owner: String
  author: User @connection(name: "UserMessages", keyField: "userId")
#  authorOrg: Organization @connection(fields: ["authorOrgId"])
  room: Group @connection(name: "RoomMessages", keyField: "roomId")
}
type Subscription {
  onCreateMessageByRoomId(roomId: ID!): Message
    @aws_subscribe(mutations: ["createMessage"])
}

type ResourceRoot 
@model 
 @auth(rules: [
   { allow: groups, groups: ["verifiedUsers"], operations: [read] }
     { allow: groups, groups: ["admin"]}
   ])
 @key(name: "resourceByOrganization", fields: ["organizationId","groupId"])
 {
  id: ID!
  type: String
  groupId: String
  organizationId: ID!
  owner:String
  resources: [Resource] @connection(name:"r1",keyField: "resourceID",sortField:"order")
  organization: Organization @connection(fields: ["organizationId"])

}
type Resource 
@model 
@auth(rules: [
   {allow: owner, ownerField: "owner", operations: [create, read, update, delete]}
  { allow: groups, groups: ["verifiedUsers"], operations: [read] }
   { allow: groups, groups: ["admin"]}
  ])
 @key(name: "byResource", fields: ["resourceID"])
{
  id: ID!
  owner:String
  type: String
  menuTitle: String
  order:String
  title: String
  subtitle:String
  image: Image
  description: String
  whoIsThisFor: String
  extendedDescription: String
  series: [ResourceSeries] @connection(name:"r2",keyField: "seriesID")
  resourceID:ID!
  resourceRoot: ResourceRoot! @connection(name:"r1",keyField:"resourceID")
}
type ResourceSeries 
@model 
@auth(rules: [
     {allow: owner, ownerField: "owner", operations: [create, read, update, delete]}

  { allow: groups, groups: ["verifiedUsers"] , operations: [read]}
   { allow: groups, groups: ["admin"]}
  ])
 @key(name: "byResourceSeries", fields: ["seriesID","title"])
{
  id: ID!
  owner:String
  type: String
  title: String
  description: String
  whoIsThisFor: String
  image: String
  category: [String]
  status: String
  allFiles: String
  playlist: String
  playlistImage: String
  episodes: [ResourceEpisode] @connection(name:"r3",keyField: "episodeID")
  seriesID: ID!
  parentResource: Resource! @connection(name:"r2",keyField: "seriesID")
}

type ResourceEpisode 
@model 
@auth(rules: [
     {allow: owner, ownerField: "owner", operations: [create, read, update, delete]}
  { allow: groups, groups: ["verifiedUsers"], operations: [read] }
   { allow: groups, groups: ["admin"]}
  ]) 
 @key(name: "byResourceEpisode", fields: ["episodeID","title"])
 {
  id: ID!
  owner:String
  episodeNumber: Int
  type: String
  title: String
  description: String
  whoIsThisFor: String
  videoPreview: String
  videoLowRes: String
  videoHiRes: String
  lessonPlan: String
  activityPage: String
  episodeID:ID!
  parentSeries: ResourceSeries! @connection(name:"r3",keyField: "episodeID")
}

type Product
  @model
  @auth(rules: [
      { allow: groups, groups: ["admin"] }
      { allow: groups, groups: ["verifiedUsers"], operations: [read] }
  ])
  {
    id: ID!
    price: Float
    name: String
    description: String
    confirmationMsg: String
    payments: [Payment] @connection(name:"paymentProduct",keyField: "productID")
    isTier: String
  }


type vodAsset @model (subscriptions: {level: public})
@auth(
  rules: [
    {allow: owner, ownerField: "owner", operations: [create, update, delete, read] },
    {allow: groups, groups:["Admin"], operations: [create, update, delete, read]},
    {allow: private, operations: [read]}
  ]
)
{
  id:ID!
  title:String!
  description:String!

  #DO NOT EDIT
  video:videoObject @connection
} 

#DO NOT EDIT
type videoObject @model
@auth(
  rules: [
    {allow: owner, ownerField: "owner", operations: [create, update, delete, read] },
    {allow: groups, groups:["Admin"], operations: [create, update, delete, read]},
    {allow: private, operations: [read]}
  ]
)
{
  id:ID!
}